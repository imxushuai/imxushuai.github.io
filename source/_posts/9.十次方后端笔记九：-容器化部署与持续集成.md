---
title: 十次方后端笔记九：容器化部署与持续集成
tags:
  - 十次方容器化部署
  - 十次方持续集成
  - Gogs
  - Jenkins
categories:
  - 十次方项目
abbrlink: 51086
date: 2002-01-02 00:00:09
---

<center><i>使用 Docker + DockerMaven + Jenkins 构建持续集成环境</i></center>

![](https://dev.tencent.com/u/imxushuai/p/pic/git/raw/master/tensquare.jpg)

<!-- more -->

> Dockerfile与DockerMaven的使用与操作参考：
>
> [使用dockerfile构建镜像上传到云端](https://www.imxushuai.com/2019/05/06/使用dockerfile构建镜像上传到云端/)
>
> [dockermaven构建镜像并上传云端](https://www.imxushuai.com/2019/05/08/dockermaven构建镜像并上传云端/)

# 持续集成

安装`Gogs`和`Jenkins`并运行。

参考文章：

👉👉	[gogs的安装和使用](https://www.imxushuai.com/2019/05/12/gogs的安装和使用/)

👉👉	[Jenkins安装](https://www.imxushuai.com/2019/05/13/Jenkins安装/)

## 配置Jekins

### 安装Maven

1. 上传`Maven`压缩包到服务器

2. 安装Maven，解压即用。

   ```shell
   tar -zxvf apache-maven-3.3.9-bin.tar.gz
   ```

3. 配置`settings.xml`，修改本地仓库位置并添加`docker maven`插件组

   ```shell
   # 需要先进入到maven安装目录的conf目录中
   vim settings.xml
   ```

   配置文件内容如下：

   ```xml
   <?xml version="1.0" encoding="UTF-8"?>
   
   <settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd">
     
       <localRepository>/usr/local/repository</localRepository>
     <pluginGroups>
       <pluginGroup>com.spotify</pluginGroup>
     </pluginGroups>
     <proxies>
     </proxies>
     <servers>
     </servers>
     <mirrors>
     </mirrors>
     <profiles>
     </profiles>
   </settings>
   ```

4. 上传maven repository到服务器，或者运行时下载jar包也行。

### 全局配置

1. 配置`JDK`

   ![](https://dev.tencent.com/u/imxushuai/p/pic/git/raw/master/20190629235127.png)

   JAVA_HOME以实际为准

2. `Git`配置保持默认

3. 配置`Maven`

   ![](https://dev.tencent.com/u/imxushuai/p/pic/git/raw/master/20190629235331.png)

   MAVEN_HOME以实际为准

4. **点击`保存`，完成配置。**

## Jenkins使用

### 新建任务

1. 点击`新建item`，输入名称并选择`构建一个Maven项目`，然后点击`确定`。

   ![](https://dev.tencent.com/u/imxushuai/p/pic/git/raw/master/20190629235834.png)

2. `源码管理`选择`Git`并输入`Repository URL`。

   ![](https://dev.tencent.com/u/imxushuai/p/pic/git/raw/master/20190630001008.png)

3. Build

   ![](https://dev.tencent.com/u/imxushuai/p/pic/git/raw/master/20190630001128.png)

4. 点击`保存`，完成任务创建

### 运行任务

1. 返回首页，点击`运行`按钮

   ![](https://dev.tencent.com/u/imxushuai/p/pic/git/raw/master/20190630002201.png)

2. 点击左下方的进度条，查看正在执行的任务，选择查看`控制台输出`

   ![](https://dev.tencent.com/u/imxushuai/p/pic/git/raw/master/20190630002355.png)

   执行成功。
   
3. 将其他微服务采用同样的方式构建任务并执行即可。

   ![](https://dev.tencent.com/u/imxushuai/p/pic/git/raw/master/20190630173421.png)

